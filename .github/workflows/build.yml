# 工作流程的名稱，會顯示在 GitHub 的 Actions 頁面上
name: Java CI with Maven

# 觸發這個工作流程的事件
on:
  # 當有程式碼被推送到(push) main 分支時
  push:
    branches: [ "main" ]
  # 當有針對 main 分支的拉取請求(pull request)被建立或更新時
  pull_request:
    branches: [ "main" ]

# 定義工作流程中需要執行的任務
jobs:
  # 我們定義一個名為 "build" 的任務
  build:
    # 指定這個任務要跑在哪一種虛擬環境上，這裡是最新版的 Ubuntu
    runs-on: ubuntu-latest

    # 這個任務包含的步驟
    steps:
    # 步驟 1: "Checkout" 你的程式碼
    # 'uses' 關鍵字代表使用一個預先寫好的 "Action" (可重用的腳本)
    # actions/checkout@v4 會將你的專案程式碼下載到虛擬環境中
    - name: Checkout repository
      uses: actions/checkout@v4

    # 步驟 2: 設定 Java 環境
    # actions/setup-java@v4 這個 Action 會幫我們安裝好指定的 Java 版本
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'        # 指定安裝 JDK 17
        distribution: 'temurin'   # 指定 Java 的發行版 (Temurin 是個很常見的選擇)
        cache: maven              # 這是一個重要的優化：它會快取 Maven 下載的依賴套件，讓後續的建置更快

    # 步驟 3: 使用 Maven 進行建置
    # 'run' 關鍵字代表直接執行一個 shell 指令
    # 這行指令就跟我們剛剛在您電腦上執行的一模一樣
    - name: Build with Maven
      run: ./mvnw clean install
